<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AVONIC</title>
    <!-- <link rel="stylesheet" href="styles.css"> -->
    <link rel="stylesheet" href="settings.css">
    <!-- <link rel="stylesheet" href="styles-update.css"> -->
    <!-- <link rel="stylesheet" href="dashboard-module.css"> -->
    <!-- <link rel="stylesheet" href="quick-insights.css"> -->
    <link rel="icon" type="image/png" href="img/cliparts/favicon.png">
    <!-- Updated stuff -->
    <link rel="stylesheet" href="css-2026/styles.css">
    <link rel="stylesheet" href="css-2026/nav/topbar.css">
    <link rel="stylesheet" href="css-2026/nav/sidebar.css">
    <!-- Updated pages -->
     <link rel="stylesheet" href="css-2026/pages/home-page.css">
     <link rel="stylesheet" href="css-2026/pages/monitoring-page.css">
     <link rel="stylesheet" href="css-2026/pages/Dashboard/front-selection.css">
     <link rel="stylesheet" href="css-2026/pages/Dashboard/quick-insights.css">
     <link rel="stylesheet" href="css-2026/pages/Dashboard/bin-fluctuations.css">
  
    
</head>
<body>
<script>
  // Redirect to landing page if not authenticated
  if (!localStorage.getItem('avonic_token')) {
    window.location.href = 'index.html';
  }
</script>
<nav class="topbar">
    <div class="left">
            <button id="menuBtn" class="menu-btn">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
        </button>
        
        <div class="top-nav">
            <div class="logo">
                <img src="img/AVONIC LOGO (white-new).svg" alt="">
            </div>
        </div>
    </div>

    <div class="right">
         <!-- This is where the connection controls will be inserted dynamically -->
        <div id="topbar-connection-controls"></div>
    </div>

    
</nav>
      <!-- sidebar -->
<nav class="sidebar">

    
     
    <ul>
        <li>
            <a class="horizontal orientation" href="#/">
                <div class="navIconWrapper">
                     <img class="navIcon" src="img/icons/navIcons/HomeIcon.svg" alt="">
                </div>
                <span class="navName">Home</span>
            </a>
        </li>
        <li>
            <a class="horizontal orientation active" href="#/dashboard">
                <div class="navIconWrapper">
                                    <img class="navIcon"    src="img/icons/navIcons/DashboardIcon.svg" alt="">
                </div>

                <span class="navName">Dashboard</span>
            </a>
        </li>
      
       
        <li>
            <a class="horizontal orientation" href="#/settings">
                <div class="navIconWrapper">
                    <img class="navIcon" src="img/icons/navIcons/SettingsIcon.svg" alt="">
                </div>
                <span class="navName">Settings</span>
            </a>
        </li>
    </ul>


    <div class="wrapper">
        <div class="message-box">
            <h1>Support 24/7</h1>
            <p>Contact us. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim </p>
        </div>

        <div class="log-out" onclick="window.settingsNav.handleLogout()">
            <img src="img\icons\navIcons\Log-out-btn.svg" alt="">
            <div class="nav-title">Log-out</div>
        </div>
    </div>
</nav>



    <!-- end of sidebar -->

<!-- HOME -->
<div class="content home active"> 

    <!-- <div class="cont-wrapper glass">
        <div class="page-title">
            Home
        </div>
        <hr>

        <div class="machine-status">

            <h1 class="page-title sub">Machine Status</h1>

            <div class="machine-status-card-container">
             
    <div class="battery-card">
        <div class="battery-header">
            <div class="battery-title">Battery</div>
            <div class="battery-percentage-text" id="batteryPercentage">23%</div>
        </div>
        <div class="battery-circle-container">
            <div class="battery-circle medium" id="batteryCircle">
                <div class="battery-icon-wrapper">
                    <div class="battery-body">
                        <div class="battery-terminal"></div>
                        <div class="battery-fill" id="batteryFill"></div>
                    </div>
                    <div class="charging-indicator" id="chargingIndicator">
                        <div class="lightning-bolt">
                           
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    
                

                <div class="water-tank-card" id="waterTankCard">
                    <div class="tank-header">
                        <div class="tank-title">Water Tank</div>
                        <div class="tank-percentage-text" id="tankPercentage">96%</div>
                    </div>

                    <div class="gauge-container">
                        <div class="gauge-wrapper">
                            <div class="gauge-background"></div>
                            <div class="gauge-fill temp-normal" id="gaugeFill"></div>
                            
                            <div class="droplet-container temp-normal" id="dropletContainer">
                                <div class="water-droplet">
                                    <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 22C16.4183 22 20 18.4183 20 14C20 8 12 2 12 2C12 2 4 8 4 14C4 18.4183 7.58172 22 12 22Z"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tank-status-text" id="tankStatusText">Tank Full</div>

                    <div class="divider"></div>

                    <div class="temperature-section">
                        <div class="temp-icon">
                            <svg class="temp-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/>
                            </svg>
                        </div>
                        <div class="temperature-text">
                            Temperature: <span class="temperature-status temp-normal" id="temperatureStatus">Normal</span>
                        </div>
                    </div>
                </div>

                

            </div>
            
        </div>



    <div class="vermicompost-bins-card-container">
        <h1 class="page-title sub">Vermicompost Bins</h1>

        <div class="bin-wrapper">


            <div class="bin-card">

                <div class="bin-title">
                    Bin 1
                </div>

                <div class="mode-indicator">
                    <img src="" alt="">
                    <div class="mode">Auto Mode</div>
                </div>
            </div>

            <div class="bin-card">

                <div class="bin-title">
                    Bin 2
                </div>

                <div class="mode-indicator">
                    <img src="" alt="">
                    <div class="mode">Auto Mode</div>
                </div>
            </div>


        </div>
        

    </div>

    </div> -->

   <!-- <div class="cont-wrapper default">

    <div class="top">
        <div class="header-card">
            <button class="back-btn" aria-label="Go back">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>

            <div class="header-content">
                <span class="breadcrumb">Home &gt; Monitoring</span>
                <h1 class="title">Monitoring</h1>
            </div>
        </div>
    </div>

    <div class="content-body">
        
        <div class="bin-indicator-card">
            <div class="card-left">
                <h2 class="bin-title">Bin 1</h2>
                <p class="update-text">Updated 10s ago</p>
                
                <button class="refresh-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M23 4v6h-6"></path>
                        <path d="M1 20v-6h6"></path>
                        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                    </svg>
                    Refresh
                </button>
            </div>

            <div class="card-right">
                <div class="mode-container">
                    <span class="mode-label">Mode:</span>
                    <button class="mode-select">
                        Manual 
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M6 9l6 6 6-6"/>
                        </svg>
                    </button>
                </div>
               
            </div>
        </div>

        <div class="sensor-grid">
            <div class="sensor-card">
                <div class="card-info">
                    <span class="sensor-label">Soil Moisture</span>
                    <span class="sensor-status">Optimal</span>
                    <div class="sensor-value">50<span class="unit">%</span></div>
                </div>
                <div class="sensor-icon-circle">
                    <img src="img/icons/sensorIcons/SoilMoistureIcon.svg" alt="Moisture Icon">
                </div>
            </div>

            <div class="sensor-card">
                <div class="card-info">
                    <span class="sensor-label">Temperature</span>
                    <span class="sensor-status">Optimal</span>
                    <div class="sensor-value">50<span class="unit">%</span></div>
                </div>
                <div class="sensor-icon-circle">
                    <img src="img/icons/sensorIcons/TempIcon.svg" alt="Moisture Icon">
                </div>
            </div>

            <div class="sensor-card">
                <div class="card-info">
                    <span class="sensor-label">Humidity</span>
                    <span class="sensor-status">Optimal</span>
                    <div class="sensor-value">50<span class="unit">%</span></div>
                </div>
                <div class="sensor-icon-circle">
                   <img src="img/icons/sensorIcons/HumidityIcon.svg" alt="Moisture Icon">
                </div>
            </div>

            <div class="sensor-card">
                <div class="card-info">
                    <span class="sensor-label">Gas Levels</span>
                    <span class="sensor-status">Optimal</span>
                    <div class="sensor-value">50<span class="unit">%</span></div>
                </div>
                <div class="sensor-icon-circle">
                    <img src="img/icons/sensorIcons/GasIcon.svg" alt="Moisture Icon">
                </div>
            </div>
        </div>

       

    </div>  -->
</div>


       





<!-- UPDATED DASHBOARD CONTENT - Replace the existing .content.dashboard section in app.html -->

<div class="content dashboard">
   

    <!-- NEW: Card Selection View (Landing Page) -->
    <div class="dashboard-card-selection" id="dashboardCardSelection">
        <div class="dashboard-cards-container">
            
            <!-- Quick Insights Card -->
            <div class="dashboard-selection-card quick-insights-card" data-page="quick-insights">
                <div class="card-icon-wrapper">
                    <div class="card-icon">
                        <svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <!-- Lightbulb Icon -->
                            <path d="M30 10C23.3726 10 18 15.3726 18 22C18 26.4183 20.3643 30.2938 23.8571 32.3571V38.5714C23.8571 39.9091 24.948 41 26.2857 41H33.7143C35.052 41 36.1429 39.9091 36.1429 38.5714V32.3571C39.6357 30.2938 42 26.4183 42 22C42 15.3726 36.6274 10 30 10Z" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M26.2857 44.4286H33.7143" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M28.5714 47.8571H31.4286" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <!-- Lightning Bolt -->
                            <path d="M30 16V28L34 24L30 32" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    
                    <!-- Rays around icon -->
                    <div class="icon-rays">
                        <div class="ray ray-1"></div>
                        <div class="ray ray-2"></div>
                        <div class="ray ray-3"></div>
                        <div class="ray ray-4"></div>
                    </div>
                </div>
                
                <div class="card-content">
                    <h2 class="card-title">QUICK INSIGHTS</h2>
                    <p class="card-description">
                        Get instant snapshots of your bin's current conditions. View real-time sensor readings, daily averages, and quick status updates at a glance.
                    </p>
                </div>
            </div>

            <!-- Bin Fluctuations Card -->
            <div class="dashboard-selection-card bin-fluctuations-card" data-page="bin-fluctuations">
                <div class="card-icon-wrapper">
                    <div class="card-icon">
                        <!-- Bar Chart Icon -->
                        <svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="14" y="30" width="8" height="20" rx="2" fill="currentColor"/>
                            <rect x="26" y="20" width="8" height="30" rx="2" fill="currentColor"/>
                            <rect x="38" y="25" width="8" height="25" rx="2" fill="currentColor"/>
                        </svg>
                    </div>
                </div>
                
                <div class="card-content">
                    <h2 class="card-title">BIN FLUCTUATIONS</h2>
                    <p class="card-description">
                        Track environmental changes over time with detailed graphs and historical data. Analyze trends, identify patterns, and monitor bin health across multiple sensors.
                    </p>
                </div>
            </div>

        </div>
    </div>

    <!-- EXISTING: Quick Insights Content (Hidden by default) -->
    <div class="quick-insights-wrapper" id="quickInsightsContent" style="display: none;">


        <div class="cont-wrapper default">
             

         <div class="header-card">
            <!-- Back Button -->

         
                <button class="back-btn" aria-label="Go back" id="backToDashboardFromQI">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                    <div class="header-content">
                        <span class="breadcrumb">Dashboard &gt; Quick Insights</span>
                        <h1 class="title">Quick Insights</h1>
                    </div>
                
            </div>

               <!-- Top Bar: Date/Time + Bin Selector -->
      <div class="content-wrapper" style="padding: 10px; display: flex; justify-content: center;">
          <div class="qi-top-bar">
            
        <div class="qi-selection">
            <div class="qi-bin-selector">
                    <select id="qi-bin-dropdown" class="qi-dropdown">
                        <option value="1">Bin 1</option>
                        <option value="2">Bin 2</option>
                    </select>
                </div>
            

        

            <!-- Sensor Tabs (Expandable) -->
            <div class="qi-sensor-tabs">
                <button class="qi-sensor-tab active" data-sensor="soilMoisture">
                    <img src="img/icons/sensorIcons/SoilMoistureIcon.svg" alt="Soil Moisture">
                    Soil Moisture
                </button>
                <button class="qi-sensor-tab" data-sensor="temperature">
                    <img src="img/icons/sensorIcons/TempIcon.svg" alt="Temperature">
                    Temp
                </button>
                <button class="qi-sensor-tab" data-sensor="humidity">
                    <img src="img/icons/sensorIcons/HumidityIcon.svg" alt="Humidity">
                    Humidity
                </button>
                <button class="qi-sensor-tab" data-sensor="gasLevels">
                    <img src="img/icons/sensorIcons/GasIcon.svg" alt="Gas Levels">
                    Gas Levels
                </button>
            </div>
        </div>
        </div>

 <div class="qi-wrapper" >
    <div class="sensor">
        <div class="icon"></div>
        <div class="name">Temperature</div>
    </div>
    <hr>
    <!-- Main Content: Stats + Insight -->
        <div class="qi-main-content">
            <div class="qi-datetime">
                <div class="qi-date">Date: <span id="qi-current-date">Aug 26, 2025</span> <strong>(Today)</strong></div>
                <div class="qi-last-updated">Last Updated: <span id="qi-last-updated">10:30AM</span></div>
            </div>
            <!-- Left: Statistics Cards -->
            <div class="qi-stats-container">
                <div class="qi-stat-card">
                    <div class="qi-stat-label">Min</div>
                    <div class="qi-stat-value">
                        <span class="value" id="qi-min-value">27.6</span>
                        <span class="unit" id="qi-min-unit">¬∞C</span>
                    </div>
                </div>

                <div class="qi-stat-card">
                    <div class="qi-stat-label">Average</div>
                    <div class="qi-stat-value">
                        <span class="value" id="qi-avg-value">31.6</span>
                        <span class="unit" id="qi-avg-unit">¬∞C</span>
                    </div>
                </div>

                <div class="qi-stat-card">
                    <div class="qi-stat-label">Max</div>
                    <div class="qi-stat-value">
                        <span class="value" id="qi-max-value">35.6</span>
                        <span class="unit" id="qi-max-unit">¬∞C</span>
                    </div>
                </div>
            </div>

            <!-- Right: Insight Card -->
            <div class="qi-insight-card">
                <div class="qi-insight-title">Insight</div>
                <p class="qi-insight-content" id="qi-insight-text">
                    Spikes above safe range occurred 2 times today
                </p>
            </div>
        </div>

        <!-- Data Table -->
        <div class="qi-table-container">
            <table class="qi-log-table">
                <thead>
                    <tr>
                        <th>Time</th>
                        <th>Reading</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="qi-table-body">
                    <!-- Data will be populated by JavaScript -->
                    <tr>
                        <td>10:00 AM</td>
                        <td>31.2¬∞C</td>
                        <td>Normal</td>
                    </tr>
                    <tr>
                        <td>10:10 AM</td>
                        <td>35.8¬∞C</td>
                        <td>High</td>
                    </tr>
                    <tr>
                        <td>10:20 AM</td>
                        <td>28.5¬∞C</td>
                        <td>Normal</td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>
      </div>
       
        </div>
        




        
     
 </div>
        

    <!-- EXISTING: Bin Fluctuations Wrapper (Hidden by default) -->

 <!-- Bin Fluctuations Wrapper (Exact Layout Match) -->
<div class="bin-fluctuations-wrapper" id="binFluctuationsContent" style="display: none;">
    
    <div class="cont-wrapper default">
        
        <!-- Header Card -->
        <div class="header-card">
            <!-- Back Button -->
            <button class="back-btn" aria-label="Go back" id="backToDashboardFromBF">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
            <div class="header-content">
                <span class="breadcrumb">Dashboard &gt; Bin Fluctuation</span>
                <h1 class="title">Bin Fluctuation</h1>
            </div>
        </div>

        <!-- Main Content Layout -->
        <div class="bf-content-layout">
            
            <!-- Left Selection Panel -->
            <div class="bf-left-panel">
                
                <!-- Bin Selector Dropdown -->
                <div class="bf-bin-selector">
                    <select id="bf-bin-dropdown" class="bf-dropdown">
                        <option value="1">Bin 1</option>
                        <option value="2">Bin 2</option>
                    </select>
                </div>

                <!-- Sensor Tabs -->
                <div class="bf-sensor-tabs">
                    <button class="bf-sensor-tab active" data-sensor="soilMoisture">
                        <img src="img/icons/sensorIcons/SoilMoistureIcon.svg" alt="Soil Moisture">
                        <span>Soil Moisture</span>
                    </button>
                    <button class="bf-sensor-tab" data-sensor="temperature">
                        <img src="img/icons/sensorIcons/TempIcon.svg" alt="Temperature">
                        <span>Temperature</span>
                    </button>
                    <button class="bf-sensor-tab" data-sensor="humidity">
                        <img src="img/icons/sensorIcons/HumidityIcon.svg" alt="Humidity">
                        <span>Humidity</span>
                    </button>
                    <button class="bf-sensor-tab" data-sensor="gasLevels">
                        <img src="img/icons/sensorIcons/GasIcon.svg" alt="Gas Levels">
                        <span>Gas Levels</span>
                    </button>
                </div>
            </div>

            <!-- Right Content Area -->
            <div class="bf-right-panel">
                
                <!-- Grid Container -->
                <div class="bf-grid-container">
                    
                    <!-- Top Row: Sensor Title and Date Range (Full Width) -->
                    <div class="bf-grid-header">
                        <div class="bf-sensor-title-block">
                            <img src="img/icons/sensorIcons/SoilMoistureIcon.svg" alt="Soil Moisture" class="bf-header-icon" id="bf-header-icon">
                            <h2 class="bf-sensor-title-text" id="bf-sensor-title">Soil Moisture</h2>
                        </div>
                        <div class="bf-date-range-block">
                            <div class="bf-calendar-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect x="3" y="6" width="18" height="15" rx="2" stroke="currentColor" stroke-width="2"/>
                                    <path d="M3 10h18M7 3v4M17 3v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                            </div>
                            <input type="date" id="bf-date-from" class="bf-date-input" value="2026-02-14">
                            <span class="bf-date-separator">to</span>
                            <input type="date" id="bf-date-to" class="bf-date-input" value="2026-12-10">
                        </div>
                    </div>

                    <!-- Middle Row: Average Display (Left) and Insights (Right) -->
                    <div class="bf-grid-middle-left">
                        <div class="bf-average-section">
                            <div class="bf-average-label">Average</div>
                            <div class="bf-average-value-display">
                                <span class="bf-value-large" id="bf-avg-value">31.6</span>
                                <span class="bf-unit-large" id="bf-avg-unit">¬∞C</span>
                            </div>
                        </div>
                        <div class="bf-worm-display">
                            <img src="img/worm-conditions/Normal.png" alt="Worm Condition" id="bf-worm-image" class="bf-worm-img">
                        </div>
                    </div>

                    <div class="bf-grid-middle-right">
                        <div class="bf-insights-card">
                            <div class="bf-insights-card-header">
                                <h3>Insights</h3>
                                <button class="bf-action-btn" id="bf-action-btn" aria-label="View Actions">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M21.71 20.29L18 16.61C19.2306 15.0944 19.8937 13.1836 19.8762 11.219C19.8588 9.25435 19.1618 7.35583 17.9024 5.86351C16.643 4.37118 14.8952 3.36726 12.9612 3.01948C11.0272 2.6717 9.02607 2.9999 7.29889 3.95132C5.57171 4.90274 4.22714 6.42073 3.49346 8.24374C2.75978 10.0668 2.68356 12.0803 3.27813 13.9503C3.8727 15.8202 5.10299 17.4289 6.76183 18.5114C8.42068 19.5938 10.4072 20.0864 12.3896 19.9077C14.372 19.7291 16.2365 18.8894 17.66 17.52L21.29 21.15C21.3834 21.2438 21.4943 21.3181 21.6161 21.3689C21.7379 21.4197 21.8684 21.4461 22 21.4461C22.1316 21.4461 22.2621 21.4197 22.3839 21.3689C22.5057 21.3181 22.6166 21.2438 22.71 21.15C22.8903 20.9625 22.9913 20.7113 22.9913 20.45C22.9913 20.1887 22.8903 19.9375 22.71 19.75L21.71 20.29ZM12.5 18C11.2089 18 9.93552 17.6896 8.77772 17.0952C7.61992 16.5008 6.60723 15.6388 5.82736 14.5747C5.04749 13.5106 4.52184 12.2731 4.29324 10.9639C4.06463 9.65466 4.13977 8.31046 4.51246 7.03643C4.88515 5.7624 5.54478 4.59418 6.43817 3.61783C7.33156 2.64148 8.43574 1.88118 9.66683 1.39335C10.8979 0.905524 12.2236 0.704152 13.5401 0.803895C14.8566 0.903638 16.1314 1.30162 17.2704 1.96885C18.4095 2.63608 19.3838 3.55518 20.1219 4.65698C20.8599 5.75878 21.3424 7.01386 21.5334 8.32807C21.7245 9.64229 21.6194 10.9831 21.2257 12.2507C20.832 13.5184 20.1589 14.6798 19.256 15.6534C18.3531 16.6271 17.242 17.3887 16.0035 17.8841C14.765 18.3795 13.4291 18.5968 12.09 18.52L12.5 18Z" fill="currentColor"/>
                                        <path d="M14.29 10.29L12 12.59L9.70999 10.29C9.61695 10.1968 9.50626 10.1228 9.38496 10.0723C9.26366 10.0219 9.13403 9.99591 9.00299 9.99591C8.87195 9.99591 8.74232 10.0219 8.62102 10.0723C8.49972 10.1228 8.38903 10.1968 8.29599 10.29C8.11032 10.4777 8.00595 10.7321 8.00595 11C8.00595 11.2679 8.11032 11.5223 8.29599 11.71L11.29 14.71C11.3834 14.8037 11.4943 14.878 11.6161 14.9289C11.7379 14.9797 11.8684 15.0061 12 15.0061C12.1316 15.0061 12.2621 14.9797 12.3839 14.9289C12.5057 14.878 12.6166 14.8037 12.71 14.71L15.71 11.71C15.8037 11.6166 15.878 11.5057 15.9289 11.3839C15.9797 11.2621 16.0061 11.1316 16.0061 11C16.0061 10.8684 15.9797 10.7379 15.9289 10.6161C15.878 10.4943 15.8037 10.3834 15.71 10.29C15.617 10.1968 15.5063 10.1228 15.385 10.0723C15.2637 10.0219 15.134 9.99591 15.003 9.99591C14.872 9.99591 14.7423 10.0219 14.621 10.0723C14.4997 10.1228 14.389 10.1968 14.296 10.29H14.29Z" fill="currentColor"/>
                                    </svg>
                                </button>
                            </div>
                            <p class="bf-insights-text" id="bf-insights-text">Loading insights...</p>
                        </div>
                    </div>

                    <!-- Bottom Row: Chart (Full Width) -->
                    <div class="bf-grid-chart">
                        <div class="bf-chart-wrapper" id="bf-chart-wrapper">
                            <canvas id="bf-chart-canvas"></canvas>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </div>

    <!-- Actions Modal -->
    <div class="bf-modal-overlay" id="bf-modal-overlay">
        <div class="bf-modal-container">
            <button class="bf-modal-close" id="bf-modal-close">√ó</button>
            
            <div class="bf-modal-header">
                <h2 class="bf-modal-title">Actions</h2>
                <p class="bf-modal-subtitle">Recommended steps to improve conditions</p>
            </div>

            <div class="bf-actions-list" id="bf-actions-list">
                <!-- Actions will be inserted here dynamically -->
            </div>
        </div>
    </div>

</div>
<!-- END OF BIN FLUCTUATIONS -->
<!-- END OF DASHBOARD PAGE -->

   


<!-- SETTINGS PAGE -->
<!-- ====== SETTINGS HUB PAGE ====== -->
<div class="content settings">
<img class="main logo mobile" src="img/avonic-logo-text-drkgrn.svg" alt="">
     <h1 class="page-header">Settings</h1>
    <div class="settings-hub">
        
       
        
        <div class="settings-card-container">
            <!-- My Account Card -->
            <div class="settings-nav-card" onclick="window.settingsNav.navigateToAccount()">
                <div class="icon">
                    <img src="/settings-content/settings-img/user-account.png" alt="Account">
                </div>
                <div class="title">My Account</div>
            </div>
            
            <!-- User Manual Card -->
            <div class="settings-nav-card" onclick="window.settingsNav.navigateToUserManual()">
                <div class="icon">
                    <img src="/settings-content/settings-img/user-manual.png" alt="Manual">
                </div>
                <div class="title">User Manual</div>
            </div>

            <!-- WiFi Settings Card -->
            <div class="settings-nav-card" onclick="window.settingsNav.navigateToClaim()">
                <div class="icon">
                    <span style="font-size: 24px;">üîó</span> 
                </div>
                <div class="title">Claim Device</div>
            </div>

            <!-- Logout Card -->
            <div class="settings-nav-card" onclick="window.settingsNav.handleLogout()">
                <div class="icon">
                    <img src="/settings-content/settings-img/log-out.png" alt="Logout">
                </div>
                <div class="title">Log-out</div>
            </div>
        </div>
    </div>
</div>

<!-- ====== ACCOUNT SETTINGS PAGE ====== -->
<div class="content settings-account">
    <div class="account-settings-page">
        <!-- Page Title with Back Button -->
        <div class="page-title">
            <button class="back-btn" onclick="window.location.hash='#/settings'">
                <img src="/settings-content/settings-img/back-button.svg" alt="Back" class="back-icon">
            </button>
            <div class="title-text">
                <p class="settings-label">Settings</p>
                <h1>Account</h1>
            </div>
        </div>

        <!-- Cards Grid -->
        <div class="cards-grid">
            <!-- Username Card (Read-only) -->
            <div class="settings-card">
                <div class="card-header">
                    <h2>Username</h2>
                </div>
                <input type="text" id="account-username" class="input-field" placeholder="Loading..." readonly>
            </div>

            <!-- Email Card (Editable) -->
            <div class="settings-card">
                <div class="card-header">
                    <h2>Email</h2>
                    <button class="edit-btn" onclick="toggleEmailEdit()">Edit</button>
                </div>
                <input type="email" id="account-email" class="input-field" placeholder="Loading..." readonly>
            </div>

            <!-- Password Card -->
            <div class="settings-card password-card">
                <div class="card-header">
                    <h2>Password</h2>
                    <button class="edit-btn" onclick="togglePasswordEdit()">Edit</button>
                </div>
                <p class="card-description">Modify your current password</p>
                
                <div class="password-inputs">
                    <div class="password-field-wrapper">
                        <label>New Password</label>
                        <div class="password-input-group">
                            <img src="/settings-content/settings-img/Account/lock-icon.svg" alt="Lock" class="lock-icon">
                            <input type="password" class="input-field password-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" readonly>
                            <button class="toggle-password" onclick="togglePasswordVisibility(this)">
                                <img src="/settings-content/settings-img/Account/close-eyes.svg" alt="Show" class="eye-icon">
                            </button>
                        </div>
                    </div>

                    <div class="password-field-wrapper">
                        <label>Repeat New Password</label>
                        <div class="password-input-group">
                            <img src="/settings-content/settings-img/Account/lock-icon.svg" alt="Lock" class="lock-icon">
                            <input type="password" class="input-field password-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" readonly>
                            <button class="toggle-password" onclick="togglePasswordVisibility(this)">
                                <img src="/settings-content/settings-img/Account/close-eyes.svg" alt="Show" class="eye-icon">
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Claimed Bins Card -->
            
            <div class="settings-card bins-card">
                <h2>Claimed Bins</h2>
                <p class="card-description">Manage your connected devices</p>
                
                <div class="bins-list" id="account-bins-list">
                    <!-- Bins will be loaded dynamically -->
                    <div style="text-align: center; padding: 20px; color: #808080;">
                        Loading your devices...
                    </div>
                </div>

                <button class="view-more-btn">View More</button>
            </div>
        </div>
    </div>
</div>


<!-- ====== CLAIM DEVICE PAGE ====== -->
<div class="content settings-claim">
    <div class="account-settings-page"> <div class="page-title">
            <button class="back-btn" onclick="window.location.hash='#/settings'">
                <img src="/settings-content/settings-img/back-button.svg" alt="Back" class="back-icon">
            </button>
            <div class="title-text">
                <p class="settings-label">Settings</p>
                <h1>Claim Device</h1>
            </div>
        </div>

        <div class="settings-card" style="max-width: 600px; margin: 0 auto;">
            <div class="claim-header" style="text-align: center; margin-bottom: 20px;">
                <h2 style="font-size: 20px; color: #2c3e50;">Link New Device</h2>
                <p style="color: #7f8c8d; font-size: 14px;">Enter your ESP32 device ID</p>
            </div>

            <div id="settings-claim-alert" class="alert" style="display:none;"></div>

            <form id="settings-claim-form" onsubmit="window.settingsNav.handleClaimSubmit(event)">
                <div class="form-group" style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;">ESP Device ID</label>
                    <input 
                        type="text" 
                        id="settings-esp-id" 
                        class="input-field" 
                        placeholder="e.g. AVONIC-A1B2C3" 
                        maxlength="22" 
                        style="text-transform: uppercase; font-family: monospace;"
                        required
                    >
                </div>

                <button type="submit" class="connect-btn" style="width: 100%; margin-top: 10px;">
                    üéØ Claim Device
                </button>
            </form>

            <div id="settings-claim-loading" style="display:none; text-align: center; margin-top: 20px;">
                <div class="spinner"></div>
                <p>Verifying device...</p>
            </div>

            <div id="settings-claim-success" style="display:none; background: #e8f5e9; padding: 15px; border-radius: 8px; margin-top: 20px;">
                <h3 style="color: #2e7d32; margin: 0;">‚úÖ Success!</h3>
                <p style="color: #1b5e20; margin: 5px 0 0 0;">Device linked successfully.</p>
            </div>

            <div class="help-text" style="margin-top: 25px; background: #fff3cd; padding: 15px; border-radius: 4px; font-size: 13px; color: #856404;">
                <strong>Where to find your ID:</strong><br>
                Check the LCD screen on your device for "ESP-ID".
            </div>
        </div>
    </div>
</div>

<!-- ====== CURRENT PASSWORD MODAL ====== -->
<div id="current-password-modal" class="modal-overlay">
    <div class="modal-card">
        <h2 class="modal-title">Current Password</h2>
        <p class="modal-description">Type your current password to change the existing password</p>
        
        <div class="password-input-group" style="margin-bottom: 24px;">
            <img src="/settings-content/settings-img/Account/lock-icon.svg" alt="Lock" class="lock-icon">
            <input type="password" class="input-field" placeholder="Enter current password" 
                   style="padding-left: 44px; padding-right: 44px;">
            <button class="toggle-password" onclick="togglePasswordVisibility(this)">
                <img src="/settings-content/settings-img/Account/close-eyes.svg" alt="Show" class="eye-icon">
            </button>
        </div>

        <div class="modal-buttons">
            <button class="modal-btn btn-primary" onclick="submitCurrentPassword()">Enter</button>
            <button class="modal-btn btn-secondary" onclick="closeCurrentPasswordModal()">Cancel</button>
        </div>
    </div>
</div>

<!-- ====== UNCLAIM DEVICE MODAL ====== -->
<div id="unclaim-modal" class="modal-overlay">
    <div class="modal-card">
        <h2 class="modal-title">‚ö†Ô∏è Unclaim Device</h2>
        <p class="modal-description">
            Are you sure you want to unclaim <strong id="unclaim-device-name"></strong>?
        </p>
        <p class="modal-description" style="color: #D32F2F; font-weight: 600;">
            This device will no longer sync data to your account.
        </p>

        <div class="modal-buttons">
            <button class="modal-btn btn-primary" onclick="confirmUnclaim()">Yes, Unclaim</button>
            <button class="modal-btn btn-secondary" onclick="closeUnclaimModal()">Cancel</button>
        </div>
    </div>
</div>

<!-- ====== SUCCESS MODAL (Optional) ====== -->
<div id="save-changes-modal" class="modal-overlay">
    <div class="modal-card">
        <div class="illustration">
            <img src="/settings-content/settings-img/are-you-sure.svg" alt="Success">
        </div>
        <h2 class="modal-title">Save changes?</h2>
        <p class="modal-description">Your changes will be saved</p>
        <div class="modal-buttons">
            <button class="modal-btn btn-primary">Save</button>
            <button class="modal-btn btn-secondary">Cancel</button>
        </div>
    </div>
</div>

<!-- Success Modal -->
<div id="success-modal" class="modal-overlay" style="display: none;">
    <div class="modal-card">
        <div class="illustration">
            <img src="/img/form-icons/success-icon.svg" alt="Success" style="width: 80px; height: 80px;">
        </div>
        <h2 class="modal-title">Success!</h2>
        <p class="modal-description" id="success-modal-msg">Changes saved successfully.</p>
        <div class="modal-buttons">
            <button class="modal-btn btn-primary" onclick="window.closeSuccessModal()">OK</button>
        </div>
    </div>
</div>

<!-- ‚úÖ CRITICAL: Load Chart.js FIRST (required by dashboard charts) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>

<!-- ‚úÖ CRITICAL: Load in this exact order! -->

<!-- 1. Configuration (must load first) -->
<script src="js/config/api-config.js"></script>

<!-- 2. Utilities (no dependencies) -->
<script src="js/utils/data-stats.js"></script>
<script src="js/utils/sensor-units.js"></script>
<script src="js/utils/dummy-data.js"></script>

<!-- 3. API Client (auth layer) -->
<script src="js/services/api-client.js"></script>

<!-- 4. Core Services (depend on API client) -->
<script src="js/services/device-service.js"></script>
<script src="js/services/sensor-service.js"></script>
<script src="js/services/chart-service.js"></script>

<!-- 5. Core Components (no dependencies) -->
<script src="js/components/dev-mode.js"></script>
<script src="js/components/worm-conditions.js"></script>
<script src="js/components/toast-notifications.js"></script>

<!-- 6. UI Components (depend on core) -->
<script src="js/components/modal-system.js"></script>
<script src="js/components/card-visuals.js"></script>
<script src="js/components/bin-card.js"></script>
<script src="js/components/status-card.js"></script>
<script src="js/components/mode-switcher.js"></script>
<script src="js/components/chart-renderer.js"></script>

<!-- 7. Feature Modules (depend on UI) -->
<script src="js/components/nickname-manager.js"></script>
<script src="js/components/claim-device.js"></script>

<!-- 8. Page Loaders (depend on everything) -->
<script src="js/components/dashboard-loader.js"></script>
<script src="js/components/bin-page-loader.js"></script>

<!-- 9. Dashboard Module (depends on services & components) -->
<script src="js/dashboard/sensor-configs.js"></script>
<script src="js/dashboard/worm-evaluator.js"></script>
<script src="js/dashboard/insights-manager.js"></script>
<script src="js/dashboard/data-fetcher.js"></script>
<script src="js/dashboard/chart-creator.js"></script>
<script src="js/dashboard/modal-controller.js"></script>
<script src="js/dashboard-module.js"></script>
<script src="js/dashboard/dashboard-nav.js"></script>

<!-- 10. Auto-refresh (orchestrates data fetching) -->
<script src="js/services/auto-refresh.js"></script>

<!-- 11. Main Orchestrators -->
<script src="js/main_components.js"></script>
<script src="js/data_integration.js"></script>

<!-- 12. Other App Scripts -->
<!-- ‚úÖ QUICK INSIGHTS MODULE - Load in this exact order! -->

<!-- 1. Configurations -->
<script src="js/insights/sensor-configs.js"></script>
<script src="js/insights/dummy-data.js"></script>

<!-- 2. Core Services -->
<script src="js/insights/esp-validator.js"></script>
<script src="js/insights/data-fetcher.js"></script>

<!-- 3. Utilities -->
<script src="js/insights/stats-calculator.js"></script>
<script src="js/insights/insight-generator.js"></script>

<!-- 4. UI Handlers -->
<script src="js/insights/table-renderer.js"></script>
<script src="js/insights/tab-handler.js"></script>
<!-- ‚úÖ BIN FLUCTUATIONS MODULE - Load in this exact order! -->

<!-- 1. Configurations & State -->
<script src="js/fluctuations/sensor-configs.js"></script>
<script src="js/fluctuations/state-manager.js"></script>

<!-- 2. Core Services -->
<script src="js/fluctuations/data-fetcher.js"></script>
<script src="js/fluctuations/insights-generator.js"></script>

<!-- 3. UI Managers -->
<script src="js/fluctuations/chart-manager.js"></script>
<script src="js/fluctuations/ui-updater.js"></script>
<script src="js/fluctuations/nav-controller.js"></script>
<script src="js/fluctuations/date-picker.js"></script>

<!-- 4. Main Entry Point -->
<script src="js/bin-fluctuations.js"></script>

<!-- 5. Main Entry Point -->
<script src="js/quick-insights.js"></script>
<script src="js/auth.js"></script>
<script src="js/url-router.js"></script>
<script src="js/other_widgets.js"></script>
<script src="js/settings.js"></script>

<!-- ‚ùå REMOVED: These files don't exist -->
<!-- <script src="js/dashboard_components.js"></script> -->
<!-- <script src="js/mqtt_integration.js"></script> -->

    <script>
// Debug: Check router initialization
setTimeout(() => {
    console.log('=== ROUTER DEBUG ===');
    console.log('Router exists:', typeof window.router !== 'undefined');
    console.log('Current hash:', window.location.hash);
    console.log('Active pages:', document.querySelectorAll('.content.active').length);
    console.log('===================');
}, 1000);
</script>

<script>
    const menuBtn = document.getElementById('menuBtn');
    const body = document.body;

    menuBtn.addEventListener('click', () => {
        // Toggle the .collapsed class on the body
        body.classList.toggle('collapsed');
    });
</script>

<div id="devControls" class="dev-controls-panel minimized">
    <div class="dev-header" onclick="toggleDevPanel()">
        <span>üõ† Dev Controls</span>
        <button class="toggle-btn" id="devToggleBtn">+</button>
    </div>
    
    <div class="dev-content">
        <div class="dev-section">
            <h4>üîã Battery</h4>
            <label>Level: <span id="currentValue">23</span>%</label>
            <input type="range" id="batterySlider" min="0" max="100" value="23">
            
            <div class="charging-toggle">
                <input type="checkbox" id="chargingToggle">
                <label for="chargingToggle">Charging Mode</label>
            </div>
            <div class="status-display" id="statusDisplay">Medium Battery</div>
        </div>

        <hr>

        <div class="dev-section">
            <h4>üö∞ Water Tank</h4>
            <label>Level: <span id="waterLevelValue">96%</span></label>
            <input type="range" id="waterLevelSlider" min="0" max="100" value="96">
            
            <label>Temp Status:</label>
            <select id="tempStatusSelect">
                <option value="Normal" selected>Normal</option>
                <option value="High">High</option>
                <option value="Low">Low</option>
            </select>
            
            <div id="waterStatusDisplay" class="status-display status-high">
                Tank Level: HIGH
            </div>
        </div>
    </div>
</div>


 <div id="sensorDevControls" class="dev-panel minimized">
    <div class="dev-header" onclick="toggleSensorPanel()">
        <span>üß™ Sensor Controls</span>
        <button class="toggle-btn" id="sensorToggleBtn">+</button>
    </div>
    
    <div class="dev-content">
        <div class="dev-section">
            <label class="dev-label">Simulation</label>
            <p class="dev-desc">Randomize values to test color states and circular progress.</p>
            
            <button class="dev-action-btn" onclick="randomizeSensors()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M23 4v6h-6"></path>
                    <path d="M1 20v-6h6"></path>
                    <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                </svg>
                Randomize Values
            </button>
        </div>
    </div>
</div>

<script>
    function toggleDevPanel() {
        const panel = document.getElementById('devControls');
        const btn = document.getElementById('devToggleBtn');
        
        panel.classList.toggle('minimized');
        
        // Update button symbol
        if (panel.classList.contains('minimized')) {
            btn.textContent = '+';
        } else {
            btn.textContent = '‚àí'; // Minus sign or X
        }
    }
</script>

 <script>
  // Battery Card Controller
        class BatteryCard {
            constructor(circleId, fillElementId, percentageElementId, chargingIndicatorId, initialLevel = 23) {
                this.circleElement = document.getElementById(circleId);
                this.fillElement = document.getElementById(fillElementId);
                this.percentageElement = document.getElementById(percentageElementId);
                this.chargingIndicator = chargingIndicatorId ? document.getElementById(chargingIndicatorId) : null;
                this.level = initialLevel;
                this.isCharging = false;
                this.updateDisplay();
            }

            setLevel(percentage) {
                this.level = Math.max(0, Math.min(100, percentage));
                this.updateDisplay();
            }

            setCharging(charging) {
                this.isCharging = charging;
                
                // Toggle charging indicator
                if (this.chargingIndicator) {
                    if (charging) {
                        this.chargingIndicator.classList.add('active');
                    } else {
                        this.chargingIndicator.classList.remove('active');
                    }
                }
                
                // Toggle charging animation on battery fill
                if (this.fillElement) {
                    if (charging) {
                        this.fillElement.style.setProperty('--current-level', `${this.level}%`);
                        this.fillElement.classList.add('charging');
                    } else {
                        this.fillElement.classList.remove('charging');
                    }
                }
            }

            updateDisplay() {
                if (this.fillElement && this.percentageElement && this.circleElement) {
                    // Update fill WIDTH (battery is horizontal)
                    this.fillElement.style.width = `${this.level}%`;
                    
                    // Update CSS variable for charging animation
                    if (this.isCharging) {
                        this.fillElement.style.setProperty('--current-level', `${this.level}%`);
                    }
                    
                    // Update percentage text
                    this.percentageElement.textContent = `${this.level}%`;
                    
                    // Update gradient color based on battery level
                    this.circleElement.classList.remove('high', 'medium', 'low');
                    
                    if (this.level > 60) {
                        this.circleElement.classList.add('high');
                    } else if (this.level >= 20) {
                        this.circleElement.classList.add('medium');
                    } else {
                        this.circleElement.classList.add('low');
                    }
                }
            }

            getLevel() {
                return this.level;
            }

            getStatus() {
                if (this.level > 60) return 'high';
                if (this.level >= 20) return 'medium';
                return 'low';
            }

            getStatusText() {
                const status = this.getStatus();
                if (status === 'high') return 'High Battery';
                if (status === 'medium') return 'Medium Battery';
                return 'Low Battery';
            }

            isChargingActive() {
                return this.isCharging;
            }
        }

        // Initialize battery card
        const battery = new BatteryCard('batteryCircle', 'batteryFill', 'batteryPercentage', 'chargingIndicator', 23);

        // Control panel functionality
        const slider = document.getElementById('batterySlider');
        const currentValue = document.getElementById('currentValue');
        const statusDisplay = document.getElementById('statusDisplay');
        const chargingToggle = document.getElementById('chargingToggle');

        function updateStatusDisplay() {
            const status = battery.getStatus();
            statusDisplay.className = `status-display status-${status}`;
            statusDisplay.textContent = battery.getStatusText();
        }

        slider.addEventListener('input', (e) => {
            const value = parseInt(e.target.value);
            battery.setLevel(value);
            currentValue.textContent = value;
            updateStatusDisplay();
        });

        chargingToggle.addEventListener('change', (e) => {
            battery.setCharging(e.target.checked);
        });

        // Initialize status display
        updateStatusDisplay();

        // ===== HOW TO USE IN YOUR PROJECT =====
        
        /* 
        // Initialize battery card with charging indicator
        const myBattery = new BatteryCard(
            'batteryCircle',        // Circle element ID
            'batteryFill',          // Fill element ID
            'batteryPercentage',    // Percentage text ID
            'chargingIndicator',    // Charging indicator ID
            45                      // Initial level (optional, default is 23)
        );

        // Update battery level
        myBattery.setLevel(75);

        // Toggle charging indicator
        myBattery.setCharging(true);  // Show flat lightning bolt ‚ö°
        myBattery.setCharging(false); // Hide lightning bolt

        // Get battery info
        console.log(myBattery.getLevel());           // Returns: 75
        console.log(myBattery.getStatus());          // Returns: 'high', 'medium', or 'low'
        console.log(myBattery.getStatusText());      // Returns: 'High Battery', etc.
        console.log(myBattery.isChargingActive());   // Returns: true/false

        // Connect to API
        async function updateFromAPI() {
            const response = await fetch('/api/battery-status');
            const data = await response.json();
            
            myBattery.setLevel(data.level);
            myBattery.setCharging(data.isCharging);
        }
        
        setInterval(updateFromAPI, 3000); // Update every 3 seconds
        */
    </script>

    <script>
        /**
         * WaterTankCard Class
         * Manages the water tank status card component
         * 
         * Usage:
         * const tank = new WaterTankCard('waterTankCard');
         * tank.setWaterLevel(75); // Set water level 0-100%
         * tank.setTemperature('Normal'); // 'Normal', 'High', or 'Low'
         */
        class WaterTankCard {
            constructor(cardId) {
                this.card = document.getElementById(cardId);
                this.percentageElement = this.card.querySelector('#tankPercentage');
                this.gaugeFill = this.card.querySelector('#gaugeFill');
                this.dropletContainer = this.card.querySelector('#dropletContainer');
                this.statusText = this.card.querySelector('#tankStatusText');
                this.temperatureStatus = this.card.querySelector('#temperatureStatus');
                
                this.waterLevel = 96;
                this.temperature = 'Normal';
                
                this.updateGauge();
            }

            /**
             * Set water level (0-100%)
             * @param {number} level - Water level percentage
             */
            setWaterLevel(level) {
                this.waterLevel = Math.max(0, Math.min(100, level));
                this.updateGauge();
            }

            /**
             * Set temperature status
             * @param {string} status - 'Normal', 'High', or 'Low'
             */
            setTemperature(status) {
                this.temperature = status;
                this.updateTemperature();
                this.updateGaugeColor();
            }

            /**
             * Update gauge fill based on water level
             */
            updateGauge() {
                this.percentageElement.textContent = `${Math.round(this.waterLevel)}%`;
                
                // Rotate the gauge from -90deg (0%) to 90deg (100%)
                // At 0%: rotate to hide (extra rotation)
                // At 100%: no rotation needed
                const rotationDegrees = -180 + (this.waterLevel / 100) * 180;
                this.gaugeFill.style.transform = `rotate(${rotationDegrees}deg)`;
                
                this.updateStatusText();
            }

            /**
             * Update gauge and droplet colors based on temperature
             */
            updateGaugeColor() {
                this.gaugeFill.classList.remove('temp-normal', 'temp-high', 'temp-low');
                this.dropletContainer.classList.remove('temp-normal', 'temp-high', 'temp-low');

                const tempClass = `temp-${this.temperature.toLowerCase()}`;
                this.gaugeFill.classList.add(tempClass);
                this.dropletContainer.classList.add(tempClass);
            }

            /**
             * Update status text based on water level
             */
            updateStatusText() {
                if (this.waterLevel > 80) {
                    this.statusText.textContent = 'Tank Full';
                } else if (this.waterLevel > 50) {
                    this.statusText.textContent = 'Tank Adequate';
                } else if (this.waterLevel > 20) {
                    this.statusText.textContent = 'Tank Low';
                } else {
                    this.statusText.textContent = 'Tank Critical';
                }
            }

            /**
             * Update temperature display
             */
            updateTemperature() {
                this.temperatureStatus.textContent = this.temperature;
                this.temperatureStatus.classList.remove('temp-normal', 'temp-high', 'temp-low');
                const tempClass = `temp-${this.temperature.toLowerCase()}`;
                this.temperatureStatus.classList.add(tempClass);
            }

            /**
             * Get current water level
             * @returns {number} Current water level percentage
             */
            getWaterLevel() {
                return this.waterLevel;
            }

            /**
             * Get current temperature status
             * @returns {string} Current temperature status
             */
            getTemperature() {
                return this.temperature;
            }
        }

        // Initialize the water tank card
        const waterTank = new WaterTankCard('waterTankCard');

        // Control Panel Bindings
        const waterLevelSlider = document.getElementById('waterLevelSlider');
        const waterLevelValue = document.getElementById('waterLevelValue');
        const tempStatusSelect = document.getElementById('tempStatusSelect');
        const waterStatusDisplay = document.getElementById('waterStatusDisplay');

        waterLevelSlider.addEventListener('input', (e) => {
            const level = parseInt(e.target.value);
            waterLevelValue.textContent = `${level}%`;
            waterTank.setWaterLevel(level);
            updateWaterStatusDisplay(level);
        });

        tempStatusSelect.addEventListener('change', (e) => {
            waterTank.setTemperature(e.target.value);
        });

        function updateWaterStatusDisplay(level) {
            waterStatusDisplay.classList.remove('status-high', 'status-medium', 'status-low');
            
            if (level > 80) {
                waterStatusDisplay.textContent = 'Tank Level: HIGH (>80%)';
                waterStatusDisplay.classList.add('status-high');
            } else if (level > 50) {
                waterStatusDisplay.textContent = 'Tank Level: MEDIUM (50-80%)';
                waterStatusDisplay.classList.add('status-medium');
            } else {
                waterStatusDisplay.textContent = 'Tank Level: LOW (<50%)';
                waterStatusDisplay.classList.add('status-low');
            }
        }
    </script>

    <script>
       /* --- Toggle Panel Logic --- */
function toggleSensorPanel() {
    const panel = document.getElementById('sensorDevControls');
    const btn = document.getElementById('sensorToggleBtn');
    
    panel.classList.toggle('minimized');
    
    // Update the button symbol (+ / -)
    if (panel.classList.contains('minimized')) {
        btn.textContent = '+';
    } else {
        btn.textContent = '‚àí';
    }
}

/* --- Sensor Randomization Logic (Matches your requested behavior) --- */
function randomizeSensors() {
    const cards = document.querySelectorAll('.sensor-card');

    cards.forEach(card => {
        // 1. Generate Random Value (0 - 100)
        const newValue = Math.floor(Math.random() * 101);
        
        // 2. Determine Color & Status
        let color, statusText;
        
        if (newValue >= 30 && newValue <= 70) {
            color = '#4CAF50'; // Green (Optimal)
            statusText = "Optimal";
        } else if (newValue > 70) {
            color = '#FF5252'; // Red (High)
            statusText = "High";
        } else {
            color = '#FF9800'; // Orange (Low)
            statusText = "Low";
        }

        // 3. Update Text
        const valueDisplay = card.querySelector('.sensor-value');
        const statusDisplay = card.querySelector('.sensor-status');
        
        valueDisplay.innerHTML = `${newValue}<span class="unit">%</span>`;
        statusDisplay.textContent = statusText;
        statusDisplay.style.color = (statusText === "Optimal") ? "#999" : color;

        // 4. Update Ring Animation
        const circle = card.querySelector('.sensor-icon-circle');
        circle.style.setProperty('--p', newValue);
        circle.style.setProperty('--c', color);
    });
}

// Optional: Initialize simulation on load
// window.addEventListener('DOMContentLoaded', randomizeSensors);
    </script>


<script>
/**
 * Bin Fluctuations Module - Exact Match
 * Bar chart with swipeable functionality
 */

class BinFluctuations {
    constructor() {
        this.currentBin = 1;
        this.currentSensor = 'soilMoisture';
        this.chartInstance = null;
        this.sensorConfig = {
            temperature: {
                name: 'Temperature',
                icon: 'img/icons/sensorIcons/TempIcon.svg',
                unit: '¬∞C',
                color: '#FF6B6B',
                wormImage: 'img/worm-conditions/Normal.png'
            },
            soilMoisture: {
                name: 'Soil Moisture',
                icon: 'img/icons/sensorIcons/SoilMoistureIcon.svg',
                unit: '¬∞C',
                color: '#FDB54E',
                wormImage: 'img/worm-conditions/Normal.png'
            },
            humidity: {
                name: 'Humidity',
                icon: 'img/icons/sensorIcons/HumidityIcon.svg',
                unit: '%',
                color: '#95E1D3',
                wormImage: 'img/worm-conditions/Normal.png'
            },
            gasLevels: {
                name: 'Gas Levels',
                icon: 'img/icons/sensorIcons/GasIcon.svg',
                unit: 'ppm',
                color: '#F38181',
                wormImage: 'img/worm-conditions/Normal.png'
            }
        };

        // Touch support for swipe
        this.touchStartX = 0;
        this.touchEndX = 0;

        this.init();
    }

    init() {
        this.setupEventListeners();
        this.updateDisplay();
    }

    setupEventListeners() {
        // Bin selector
        const binDropdown = document.getElementById('bf-bin-dropdown');
        if (binDropdown) {
            binDropdown.addEventListener('change', (e) => {
                this.currentBin = parseInt(e.target.value);
                this.updateDisplay();
            });
        }

        // Sensor tabs
        const sensorTabs = document.querySelectorAll('.bf-sensor-tab');
        sensorTabs.forEach(tab => {
            tab.addEventListener('click', (e) => {
                const sensor = e.currentTarget.dataset.sensor;
                this.selectSensor(sensor);
            });
        });

        // Date inputs
        const dateFrom = document.getElementById('bf-date-from');
        const dateTo = document.getElementById('bf-date-to');
        
        if (dateFrom) {
            dateFrom.addEventListener('change', () => this.updateDisplay());
        }
        if (dateTo) {
            dateTo.addEventListener('change', () => this.updateDisplay());
        }

        // Modal handling
        const actionBtn = document.getElementById('bf-action-btn');
        const modalClose = document.getElementById('bf-modal-close');
        const modalOverlay = document.getElementById('bf-modal-overlay');
        
        if (actionBtn) {
            actionBtn.addEventListener('click', () => this.showActionsModal());
        }

        if (modalClose) {
            modalClose.addEventListener('click', () => {
                modalOverlay.classList.remove('active');
            });
        }

        if (modalOverlay) {
            modalOverlay.addEventListener('click', (e) => {
                if (e.target === modalOverlay) {
                    modalOverlay.classList.remove('active');
                }
            });
        }

        // Back button
        const backButton = document.getElementById('backToDashboardFromBF');
        if (backButton) {
            backButton.addEventListener('click', () => {
                document.getElementById('binFluctuationsContent').style.display = 'none';
                // Adjust based on your navigation system
                const dashboardPage = document.querySelector('.content.dashboard');
                if (dashboardPage) {
                    dashboardPage.style.display = 'block';
                }
            });
        }

        // Touch/Swipe support for chart
        this.setupSwipeSupport();
    }

    setupSwipeSupport() {
        const chartWrapper = document.getElementById('bf-chart-wrapper');
        if (!chartWrapper) return;

        chartWrapper.addEventListener('touchstart', (e) => {
            this.touchStartX = e.changedTouches[0].screenX;
        }, false);

        chartWrapper.addEventListener('touchend', (e) => {
            this.touchEndX = e.changedTouches[0].screenX;
            this.handleSwipe();
        }, false);

        // Mouse drag support for desktop
        let isDragging = false;
        let startX = 0;

        chartWrapper.addEventListener('mousedown', (e) => {
            isDragging = true;
            startX = e.clientX;
            chartWrapper.style.cursor = 'grabbing';
        });

        chartWrapper.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            const deltaX = e.clientX - startX;
            chartWrapper.scrollLeft -= deltaX;
            startX = e.clientX;
        });

        chartWrapper.addEventListener('mouseup', () => {
            isDragging = false;
            chartWrapper.style.cursor = 'grab';
        });

        chartWrapper.addEventListener('mouseleave', () => {
            isDragging = false;
            chartWrapper.style.cursor = 'grab';
        });

        chartWrapper.style.cursor = 'grab';
    }

    handleSwipe() {
        const swipeThreshold = 50;
        const diff = this.touchStartX - this.touchEndX;

        if (Math.abs(diff) > swipeThreshold) {
            if (diff > 0) {
                // Swiped left - can trigger chart scroll or data load
                console.log('Swiped left');
            } else {
                // Swiped right
                console.log('Swiped right');
            }
        }
    }

    selectSensor(sensor) {
        // Update active tab
        document.querySelectorAll('.bf-sensor-tab').forEach(tab => {
            tab.classList.remove('active');
        });
        const activeTab = document.querySelector(`[data-sensor="${sensor}"]`);
        if (activeTab) {
            activeTab.classList.add('active');
        }

        this.currentSensor = sensor;
        this.updateDisplay();
    }

    updateDisplay() {
        const config = this.sensorConfig[this.currentSensor];
        
        // Update header sensor icon and title
        const headerIcon = document.getElementById('bf-header-icon');
        const sensorTitle = document.getElementById('bf-sensor-title');
        
        if (headerIcon) headerIcon.src = config.icon;
        if (sensorTitle) sensorTitle.textContent = config.name;

        // Update unit
        const avgUnit = document.getElementById('bf-avg-unit');
        if (avgUnit) avgUnit.textContent = config.unit;

        // Update average value (placeholder)
        this.updateAverageValue();

        // Update worm image
        this.updateWormImage();

        // Update insights
        this.updateInsights();

        // Update chart
        this.updateChart();
    }

    updateAverageValue() {
        const avgValue = document.getElementById('bf-avg-value');
        if (avgValue) {
            // Placeholder - will be replaced with actual data
            avgValue.textContent = '31.6';
        }
    }

    updateWormImage() {
        const config = this.sensorConfig[this.currentSensor];
        const wormImage = document.getElementById('bf-worm-image');
        
        if (wormImage) {
            wormImage.src = config.wormImage;
        }
    }

    updateInsights() {
        const insightsText = document.getElementById('bf-insights-text');
        if (insightsText) {
            insightsText.textContent = 'Loading insights...';
        }
    }

    updateChart() {
        const canvas = document.getElementById('bf-chart-canvas');
        if (!canvas) return;

        const ctx = canvas.getContext('2d');
        const config = this.sensorConfig[this.currentSensor];

        // Destroy existing chart
        if (this.chartInstance) {
            this.chartInstance.destroy();
        }

        // Generate data
        const labels = this.generateDateLabels();
        const data = this.generateSampleData(labels.length);

        // Create BAR chart (matching your design)
        this.chartInstance = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: config.name,
                    data: data,
                    backgroundColor: config.color,
                    borderColor: config.color,
                    borderWidth: 1,
                    borderRadius: 8,
                    borderSkipped: false
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        padding: 12,
                        titleFont: {
                            size: 14,
                            weight: 'bold'
                        },
                        bodyFont: {
                            size: 13
                        },
                        callbacks: {
                            label: (context) => {
                                return `${context.parsed.y}${config.unit}`;
                            }
                        }
                    },
                    // Display values on top of bars
                    datalabels: false
                },
                scales: {
                    y: {
                        beginAtZero: false,
                        ticks: {
                            callback: (value) => value + config.unit,
                            font: {
                                size: 11
                            },
                            color: '#666'
                        },
                        grid: {
                            color: '#e0e0e0',
                            drawBorder: false
                        }
                    },
                    x: {
                        grid: {
                            display: false,
                            drawBorder: false
                        },
                        ticks: {
                            font: {
                                size: 12,
                                weight: '500'
                            },
                            color: '#333'
                        }
                    }
                },
                // Enable value labels on top of bars
                animation: {
                    onComplete: () => {
                        const chartInstance = this.chartInstance;
                        const ctx = chartInstance.ctx;
                        
                        ctx.font = '12px sans-serif';
                        ctx.fillStyle = '#000';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'bottom';
                        
                        chartInstance.data.datasets.forEach((dataset, i) => {
                            const meta = chartInstance.getDatasetMeta(i);
                            meta.data.forEach((bar, index) => {
                                const data = dataset.data[index];
                                ctx.fillText(data, bar.x, bar.y - 5);
                            });
                        });
                    }
                }
            }
        });
    }

    generateDateLabels() {
        // Generate 7 days of labels (matching your design)
        return ['7/11', '7/12', '7/13', '7/14', '7/15', '7/16', '7/17'];
    }

    generateSampleData(length) {
        // Generate sample data with value of 8 (matching your image)
        return Array.from({ length }, () => 8);
    }

    showActionsModal() {
        const modalOverlay = document.getElementById('bf-modal-overlay');
        const actionsList = document.getElementById('bf-actions-list');
        
        if (!modalOverlay || !actionsList) return;

        // Clear existing actions
        actionsList.innerHTML = '';

        // Get recommended actions
        const actions = this.getRecommendedActions();
        
        actions.forEach(action => {
            const actionItem = document.createElement('div');
            actionItem.className = 'bf-action-item';
            actionItem.innerHTML = `
                <h4>${action.title}</h4>
                <p>${action.description}</p>
            `;
            actionsList.appendChild(actionItem);
        });

        modalOverlay.classList.add('active');
    }

    getRecommendedActions() {
        // Generate actions based on sensor type
        const actions = {
            temperature: [
                {
                    title: 'Monitor Temperature Levels',
                    description: 'Temperature is within normal range. Continue monitoring for any significant changes.'
                },
                {
                    title: 'Ensure Proper Ventilation',
                    description: 'Make sure the bin has adequate airflow to maintain optimal temperature.'
                }
            ],
            soilMoisture: [
                {
                    title: 'Check Moisture Levels',
                    description: 'Soil moisture appears stable. Maintain current watering schedule.'
                },
                {
                    title: 'Monitor for Dry Spots',
                    description: 'Check different areas of the bin to ensure even moisture distribution.'
                }
            ],
            humidity: [
                {
                    title: 'Maintain Humidity Balance',
                    description: 'Current humidity levels are optimal for worm activity.'
                }
            ],
            gasLevels: [
                {
                    title: 'Monitor Gas Levels',
                    description: 'Gas levels are within safe range. No immediate action required.'
                }
            ]
        };

        return actions[this.currentSensor] || [
            {
                title: 'Monitor Conditions',
                description: 'All parameters are within normal range.'
            }
        ];
    }

    // Method to load real data
    loadData(binId, sensor, dateFrom, dateTo) {
        console.log(`Loading data for Bin ${binId}, Sensor: ${sensor}`);
        
        // Example API call structure
        /*
        fetch(`/api/bin-fluctuations?bin=${binId}&sensor=${sensor}&from=${dateFrom}&to=${dateTo}`)
            .then(response => response.json())
            .then(data => {
                this.updateWithData(data);
            })
            .catch(error => {
                console.error('Error loading data:', error);
            });
        */
    }

    updateWithData(data) {
        // Update UI with real data
        if (data.average) {
            document.getElementById('bf-avg-value').textContent = data.average.toFixed(1);
        }

        if (data.insights) {
            document.getElementById('bf-insights-text').textContent = data.insights;
        }

        if (data.wormCondition) {
            const wormImages = {
                'normal': 'img/worm-conditions/Normal.png',
                'too-wet': 'img/worm-conditions/Too Wet.png',
                'too-hot': 'img/worm-conditions/Too Hot.png',
                'too-dry': 'img/worm-conditions/Too Dry.png',
                'gas-high': 'img/worm-conditions/Gas Too High.png'
            };
            
            const wormImage = document.getElementById('bf-worm-image');
            if (wormImage && wormImages[data.wormCondition]) {
                wormImage.src = wormImages[data.wormCondition];
            }
        }

        // Update chart with real data
        if (data.chartData && this.chartInstance) {
            this.chartInstance.data.labels = data.chartData.labels;
            this.chartInstance.data.datasets[0].data = data.chartData.values;
            this.chartInstance.update();
        }
    }
}

// Initialize when DOM is ready
document.addEventListener('DOMContentLoaded', () => {
    if (typeof Chart === 'undefined') {
        console.error('Chart.js is required. Please include Chart.js library.');
        return;
    }

    window.binFluctuations = new BinFluctuations();
});
</script>
    


</body>
</html>